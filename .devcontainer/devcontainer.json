{
  "name": "Python 3",
  // Specifies the base image for the Codespaces container.
  "image": "mcr.microsoft.com/devcontainers/python:1-3.11-bullseye",
  // Customizes the Codespaces and VS Code environment.
  "customizations": {
    "codespaces": {
      // Files to open automatically on Codespaces startup.
      "openFiles": [
        "README.md",
        "src/test.py"
      ]
    },
    "vscode": {
      // VS Code settings (empty for default behavior).
      "settings": {},
      // Extensions for Python development.
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance"
      ]
    }
  },
  // Commands to run after container creation to install dependencies.
  "updateContentCommand": [
    // Install system packages from packages.txt if it exists.
    "[ -f packages.txt ] && sudo apt-get update && sudo apt-get upgrade -y && sudo xargs apt-get install -y <packages.txt || echo '⚠️ Failed to install system packages' >> /tmp/setup.log",
    // Upgrade pip globally.
    "python3 -m pip install --upgrade pip || echo '⚠️ Failed to upgrade pip' >> /tmp/setup.log",
    // Install Python dependencies from requirements.txt if it exists.
    "[ -f requirements.txt ] && python3 -m pip install -r requirements.txt || echo '⚠️ Failed to install Python dependencies' >> /tmp/setup.log",
    // Install Streamlit globally.
    "python3 -m pip install streamlit || echo '⚠️ Failed to install Streamlit' >> /tmp/setup.log",
    // Ensure user-level bin directory is in PATH (fallback).
    "echo 'export PATH=$PATH:$HOME/.local/bin' >> ~/.bashrc",
    // Log setup completion.
    "echo '✅ Packages installed and Requirements met' >> /tmp/setup.log"
  ],
  // Command to run after attaching to the container (starts Streamlit server).
  "postAttachCommand": {
    "server": "streamlit run src/test.py --server.enableCORS false --server.enableXsrfProtection false"
  },
  // Configure port attributes for the Streamlit app.
  "portsAttributes": {
    "8501": {
      "label": "Application",
      "onAutoForward": "openPreview"
    }
  },
  // Ports to forward for external access.
  "forwardPorts": [
    8501
  ]
}
